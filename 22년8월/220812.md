# 📖 오늘의 학습

## 스코프

### 스코프란?

> 모든 식별자는 자신이 선언된 위치에 의해 다른 코드가 식별자 자신을 참조할 수 있는 유효 범위가 결정된다. 이를 스코프라 한다. 즉, 스코프는 식별자가 유효한 범위를 말한다.

자바스크립트는 스코프를 통해 어떤 변수를 참조해야 할지 결정한다. 이를 **식별자 결정**이라고 한다.

### 스코프의 종류

- 전역과 전역 스코프
  - 전역은 코드의 가장 바깥 영역을 말한다.
  - 전역에 변수를 선언하면 전역 스코프를 갖는다. 전역 변수는 어디든 참조할 수 있다.
- 지역과 지역 스코프
  - 지역이란 함수 몸체 내부를 말한다.
  - 지역 변수는 자신의 지역 스코프와 하위 지역 스코프에서 유효하다.

### 스코프 체인

> 함수는 중첩 될 수 있으므로 지역 스코프도 중첩될 수 있다. 스코프가 함수의 중첩에 의해 계층적 구조를 갖는다는 것을 의미한다.

변수를 참조할 때 자바스크립트 엔진은 스코프 체인을 통해 변수를 참조하는 코드의 스코프에서 시작하여 상위 스코프 방향으로 이동하여 선언된 변수를 검색한다.

### 함수 레벨 스코프

var 키워드는 오로지 함수의 코드 블록만을 지역 스코프로 인정한다. 이 특성을 함수 레벨 스코프라고 함

### 렉시컬 스코프

> 함수 정의가 평가되는 시점에 상위 스코프가 정적으로 결정, 정적 스코프 렉시컬 스코프라고 한다.

함수를 어디서 정의했는지에 따라 상위 스코프를 결정한다. 호출 된 위치는 상위 스코프 결정에 어떠한 영향도 주지 않는다. 따라서 함수의 상위 스코프는 언제나 자신이 정의된 스코프다.

## 전역 변수의 문제점

### 변수의 생명 주기

- 지역 변수의 생명 주기는 함수의 생명 주기와 일치한다.
- 누군가가 메모리 공간을 참조하고 있으면 해제되지 않고 확보된 상태로 남아있게 된다.
- 호이스팅은 스코프 단위로 동작한다.
- 함수와 달리 전역 코드는 호출 없이 실행되므로 전역 변수의 생명 주기는 전역 객체의 생명 주기와 일치한다.

### 전역 변수의 문제점

- 전역 변수를 선언한 의도는 어디서든 참조하고 할당할 수 있는 변수를 사용하겠다는 것이다. 이는 모든 코드가 전역 변수를 참조하고 변경할 수 있는 암묵적 결합을 허용하는 것이다.
- 전역 변수는 생명 주기가 일어 메모리 리소스도 오랜 기간 소비한다.
- 스코프 체인 상 종점에 존재하여 검색 속도가 가장 느리다.
- 다른 파일 내 동일한 이름의 전역 변수나 함수는 예상치 못한 결과를 가져올 수 있다.

### 전역 변수의 사용을 억제하는 방법

> 전역 변수를 반드시 사용해야 할 이유를 찾지 못했다면 지역 변수를 사용해야 한다.

- 즉시 실행 함수로 모든 코드를 감싸면 모든 변수는 즉시 실행 함수의 지역 변수가 된다.
- 전역에 네임스페이스 역할을 담당할 객체를 생성하는 방법, 객체 자체가 전역 변수에 할당되므로 그다지 유용하지는 않다.
- 모듈 패턴을 이용해 전역 변수의 억제는 물론 캡슐화까지 구현할 수 있다. 자바스크립트는 접근 제한자를 제공하지 않아 모듈 패턴을 사용해 전역 네임스페이스의 오염을 막음과 동시에 한정적이지만 정보 은닉을 구현하기 위해 사용된다.
- ES6 모듈을 사용하면 전역변수를 사용할 수 없다. 파일 자체의 독자적인 모듈 스코프를 제공한다.

## let, const 키워드와 블록 레벨 스코프

- var 키워드로 선언한 변수의 문제점은 중복 선언의 오류가 발생하지 않고, 함수 레벨 스코프이므로 의도치 않은 변화가 생길 수 있으며 변수의 호이스팅이 발생하여 가독성을 떨어트리고 오류의 여지를 준다.

### let 키워드

- 중복 선언에 대한 에러를 발생시킨다.
- 모든 코드 블록을 지역 스코프로 인정하는 블록 레벨 스코프를 따른다.
- let 키워드로 선언한 변수는 선언과 초기화가 분리되어 진행된다. 초기화가 이루어지기 전에 변수에 접근하려고 하면 참조 에러가 발생한다. 스코프의 시작 지점부터 초기화 시점까지를 일시적 사각지대(TDZ)라고 부른다. (호이스팅은 발생하지만 발생하지 않는 것 처럼 동작한다.)
- let 키워드로 선언한 변수는 전역 객체의 프로퍼티가 아니다. 전역 렉시컬 환경의 선언적 환경 레코드내에 존재하게 된다.

### const 키워드

- let과 대부분의 특징이 동일하다.
- 선언과 초기화가 동시에 이루어져야 한다.
- 재할당이 금지된다.
- 원시 값을 할당할 경우 값을 변경할 수 없기 때문에 상수를 표현하는데 사용하기도 한다.
- 상수는 재할당이 금지된 변수를 말한다.
- const 키워드로 선언한 변수에 객체를 할당할 경우 값을 변경할 수 있다.
- const 키워드는 재할당을 금지할 뿐 “불변”을 의미하지는 않는다.

# 🤯 하루을 마치며…

오늘 수업이 갑작스럽게 취소되어 러버덕을 할 시간이 더 길어졌다. 다 같이 고민했더니 서로가 헷갈리는 부분에 대해 더 심도있는 토론을 할 수 있었고, 서로가 아는 지식들이 모여 긍정적인 결론으로 한걸음 더 다가갈 수 있었다. 오늘의 새로 알게 된 사실은 암묵적 전역이다. 암묵적 전역은 전역 객체의 프로퍼티로 값이 저장된다. 그리고 변수로 선언한 전역 변수는 프로퍼티 어트리뷰트의 컨피규러블 속성이 저절로 false가 되어 삭제할 수 없게 된다. 서로 질문하면서 궁금한걸 해결하기 위해 살펴보지 않았다면 그냥 넘어갈 수 있었던 부분에 대하여 깊게 생각해보며 구글링도 하고 해결하는 과정에서 지식이 점점 더 단단해져가는 것을 느낄 수 있었다. 내일부터 광복절까지 3일동안도 시간을 낭비하지 않고 부족한 부분에 대한 학습과 다음 주 러버덕 부분을 미리 읽어서 잘 따라가도록 해야겠다!
